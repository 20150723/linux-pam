.\" ** You probably do not want to edit this file directly **
.\" It was generated using the DocBook XSL Stylesheets (version 1.69.1).
.\" Instead of manually editing it, you probably should edit the DocBook XML
.\" source for it and then use the DocBook XSL Stylesheets to regenerate it.
.TH "PAM_SM_ACCT_MGMT" "3" "05/04/2006" "Linux\-PAM Manual" "Linux\-PAM Manual"
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.SH "NAME"
pam_sm_acct_mgmt \- PAM service module for account management
.SH "SYNOPSIS"
.sp
.nf
#define PAM_SM_ACCOUNT
.fi
.PP
\fB#include <security/pam_modules.h>\fR
.HP 32
\fBPAM_EXTERN\ int\ \fBpam_sm_acct_mgmt\fR\fR\fB(\fR\fBpam_handle_t\ *\fR\fB\fIpamh\fR\fR\fB, \fR\fBint\ \fR\fB\fIflags\fR\fR\fB, \fR\fBint\ \fR\fB\fIargc\fR\fR\fB, \fR\fBconst\ char\ **\fR\fB\fIargv\fR\fR\fB);\fR
.SH "DESCRIPTION"
.PP
The
\fBpam_sm_acct_mgmt\fR
function is the service module's implementation of the
\fBpam_acct_mgmt\fR(3)
interface.
.PP
This function performs the task of establishing whether the user is permitted to gain access at this time. It should be understood that the user has previously been validated by an authentication module. This function checks for other things. Such things might be: the time of day or the date, the terminal line, remote hostname, etc. This function may also determine things like the expiration on passwords, and respond that the user change it before continuing.
.PP
Valid flags, which may be logically OR'd with
\fIPAM_SILENT\fR, are:
.TP
PAM_SILENT
Do not emit any messages.
.TP
PAM_DISALLOW_NULL_AUTHTOK
Return
\fIPAM_AUTH_ERR\fR
if the database of authentication tokens for this authentication mechanism has a
\fINULL\fR
entry for the user
.SH "RETURN VALUES"
.TP
PAM_ACCT_EXPIRED
User account has expired.
.TP
PAM_AUTH_ERR
Authentication failure.
.TP
PAM_NEW_AUTHTOK_REQD
The user's authentication token has expired. Before calling this function again the application will arrange for a new one to be given. This will likely result in a call to
\fBpam_sm_chauthtok()\fR.
.TP
PAM_PERM_DENIED
Permission denied.
.TP
PAM_SUCCESS
The authentication token was successfully updated.
.TP
PAM_USER_UNKNOWN
User unknown to password service.
.SH "SEE ALSO"
.PP
\fBpam\fR(3),
\fBpam_acct_mgmt\fR(3),
\fBpam_sm_chauthtok\fR(3),
\fBpam_strerror\fR(3),
\fBPAM\fR(8)
